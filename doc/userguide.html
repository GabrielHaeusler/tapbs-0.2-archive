<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>The TAPBS-0.2 documentation</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.70.1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="d0e1"></a>The <span class="application">TAPBS-0.2 </span>documentation</h2></div><div><div class="author"><h3 class="author"><span class="firstname">Gernot</span> <span class="surname">Kieseritzky</span></h3>
             <p><code class="email">&lt;<a href="mailto:gernotf@chemie.fu-berlin.de">gernotf@chemie.fu-berlin.de</a>&gt;</code></p>
             <h3>Ilkay Sakalli</h3>
             <p><code class="email">&lt;<a href="mailto:sakalli@chemie.fu-berlin.de">sakalli@chemie.fu-berlin.de</a>&gt;</code></p>
   </div></div></div><hr></div><div class="toc"><dl><dt><span class="section"><a href="#d0e17">1. Introduction</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e20">1.1. What is <span class="application">TAPBS</span>?</a></span></dt><dt><span class="section"><a href="#d0e42">1.2. Multiple conformations</a></span></dt></dl></dd><dt><span class="section"><a href="#d0e55">2. Installation</a></span></dt><dd><dl>
          <dt><span class="section"><a href="#d0e60">2.1. Prerequisites<span class="application"></span></a></span></dt>
           <dt><span class="section"><a href="#d0e61">2.2. Quickstart<span class="application"></span></a></span></dt></dl></dd><dt><span class="section"><a href="#d0e126">3. Running</a></span></dt><dt><span class="section"><a href="#d0e138">4. Syntax of input to <code class="computeroutput">stdin</code></a></span></dt><dd><dl><dt><span class="section"><a href="#d0e143">4.1. General syntax</a></span></dt><dt><span class="section"><a href="#d0e196">4.2. List of keywords</a></span></dt></dl></dd><dt><span class="section"><a href="#d0e1515">5. File formats</a></span></dt><dd><dl><dt><span class="section"><a href="#d0e1518">5.1. PQR file format</a></span></dt><dt><span class="section"><a href="#d0e1527">5.2. SITES files (*.sites)</a></span></dt><dt><span class="section"><a href="#d0e1536">5.3. Residue state description files (*.ST)</a></span></dt><dt><span class="section"><a href="#d0e1555">5.4. Potential binary file format</a></span></dt><dt><span class="section"><a href="#d0e1635">5.5. Intrinsic pK values (*.pkint)</a></span></dt><dt><span class="section"><a href="#d0e1644">5.6. W interaction matrix (*.g)</a></span></dt></dl></dd><dt><span class="section"><a href="#d0e1649">6. Copyright</a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e17"></a>1.&nbsp;Introduction</h2></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e20"></a>1.1.&nbsp;What is <span class="application">TAPBS</span>?</h3></div></div></div>
           <p><span class="application">TAPBS</span> calculates electrostatic energies needed for continuum electrostatics based pKa and redox calculations. It prepares the input files by <span class="application">Karlsberg 2.0</span> to predict protonation and redox patterns in a protein. Essentially, <span class="application">TAPBS</span> is a front end to <span class="application">APBS 1.3</span>, a stand-alone program developed by Nathan Baker at the University of Washington to solve the linearized Poisson-Boltzmann equation (LPBE) numerically, which tries to efficiently and conveniently automate the large number of LPBE calculations needed to compute Born solvation, background and pair wise energy terms that determine pKa values. <span class="application">TAPBS</span> supports local conformational changes, multiple charged states, protein regions of different dielectric constant and implicit membrane slabs.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e42"></a>1.2.&nbsp;Multiple conformations</h3></div></div></div><p><span class="application">TAPBS</span> is able to calculate electrostatic energy shifts for conformational states of molecular groups within macromolecules to be used in Karlsberg 2.0 to predict pH-dependent conformational changes such as hydrogen bonding patterns that usually highly depends on the protonation/redox states of titratable groups. The LPBE will be solved twice for each state of a flexible group in a) the solution state and b) the protein environment. In the standard approach used by <span class="application">TAPBS</span> the protein environment consists of the combined dielectric volume of all conformers, i.e. combines all conformers as defined by the set of ST-files (see below) into a single protein volume. However, the location of the partial charges is moved for each conformational state to calculate its corresponding electrostatic potential from the solution of the LPBE. This approximation is, of course, only valid for small conformational changes such as hydrogen flexibility. For larger conformational variations one should make use of the global conformations supported by <span class="application">Karlsberg 2.0</span> as was done e.g. in Karlsberg+.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e55"></a>2.&nbsp;Installation</h2></div></div></div>
     <p></p>
     <div class="section" lang="en">
       <div class="titlepage">
         <div>
           <div>
             <h3 class="title"><a name="d0e60"></a>2.1. Prerequisities<span class="application"></span></h3>
           </div>
         </div>
       </div>
     For installing TAPBS on Ubuntu 12.04 LTS you need to have following programs installed:</div>
     <ul>
     <li>patch </li>
       <li> build-essential</li>
       <li> gfortran or ifort (recommended)</li>
       <li> ATLAS</li>
     </ul>
      <p>To install all prerequisities, you have to be root:</p>
      <pre class="programlisting">sudo apt-get install build-essential patch gfortran libatlas-dev libatlas-base-dev</pre>
      <p>(If apt-get does not find the package, first do a &quot;sudo apt-get update&quot;)<br>
      </p>
      <p>Now use our simple installer (installation will go to /opt/tapbs-0.2/):</p>
      <pre class="programlisting">cd
wget http://agknapp.chemie.fu-berlin.de/karlsberg/installTAPBS.sh
chmod +x installTAPBS.sh
sudo ./installTAPBS.sh
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/opt/tapbs-0.2/lib
</pre>
   <p>You can run TAPBS by typing:</p>
   <pre class="programlisting">% tapbs &lt; input.in &gt; output.out</pre>
   <p>For a successful run you will at least need a PQR file, a SITES file and a set of ST files.</p>
   <p>An example  is given in &quot;tapbs-0.2/example&quot;:</p>
    <pre class="programlisting">cd $SOURCEDIR/tapbs-0.2/example 
$INSTALLDIR/bin/tapbs &lt; test.in &gt; test.out</pre>
   </div>
   <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e138"></a>4.&nbsp;Syntax of input to <code class="computeroutput">stdin</code></h2></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e143"></a>4.1.&nbsp;General syntax</h3></div></div></div><p>Empty lines and lines starting with <code class="computeroutput">#</code> are ignored.</p><p>Normal lines start with a keyword (or whitespace - leading whitespace is ignored, so you can indent as you like it). A keyword may be followed by one or more arguments. Arguments are seperated by whitespace. Escaping is not possible, so do not use spaces within your arguments. Parsing always stops at <code class="computeroutput">EOF</code>. Order of lines does not have any significance, with one important exception: Most keywords should only appear once in the input. If such a keyword is used more than once, only the first appearance is recognized, all others are ignored.</p><p>In <a href="#listOfKeywords">Section&nbsp;4.2, &#8220;List of keywords&#8221;</a>, all keywords are listed together with explanation of all possible arguments. The order of arguments is significant. Optional arguments are, as the name suggests, optional, but if there are more than one optional arguments, you can only skip them beginning from the end of the arguments list, e.g. if there are three optional arguments, and you want to skip the second one, you must also skip the third one. Default values for skipped arguments are given in the description.</p><p>The possible formats of the arguments are the following:</p><div class="table"><a name="d0e162"></a><p class="title"><b>Table&nbsp;1.&nbsp;Formats of arguments</b></p><div class="table-contents"><table summary="Formats of arguments" border="1"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th>format</th><th>description</th></tr></thead><tbody><tr><td>string</td><td>string of arbitrary characters with the exception of <code class="computeroutput">#</code> and whitespace</td></tr><tr><td>integer</td><td>an integer number</td></tr><tr><td>float</td><td>a floating point number, exponential numbers in C-like format</td></tr><tr><td>energy unit</td><td>a special string, see next section</td></tr></tbody></table></div></div><br class="table-break"></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e196"></a>4.2.&nbsp;List of keywords</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p><code class="computeroutput">pqr</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>yes</td></tr><tr><td>behavior if missing</td><td>not possible</td></tr></tbody></table></div><p>Filename of the structure definition in PQR format. PQR is derived from PDB where occupancies are replaced by atomic partial charges and B-factors by atomic radii.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>PQR filename</td><td>string</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput">sites</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>yes</td></tr><tr><td>behavior if missing</td><td>not possible</td></tr></tbody></table></div><p>Filename of list of titratable residues in structure.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>sites filename</td><td>string</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput">output</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>yes</td></tr><tr><td>behavior if missing</td><td>not possible</td></tr></tbody></table></div><p>During run <span class="application">TAPBS</span> generates several files: For each titratable residue a file that contains the electrostatic potentials of all states (STEM.name-NR.potat), a PQR file defining the vdW-volume of the structure (STEM.volume.pqr), a PQR file with all titratable groups in the reference charge state (STEM.reference.pqr), the intrinsic pKa-file (STEM.pkint) and the W interaction matrix (STEM.g). The argument of this parameter is the file name stem.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>filename STEM</td><td>string</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput">bcfl</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>no</td></tr><tr><td>behavior if missing</td><td>bcfl sdh</td></tr></tbody></table></div><p>Specify the boundary condition for calculations using the coarsest grid. The boundary grid points can either be initialized with 0.0 ("zero") or using an analytic expression of the electrostatic potential in the Debye-H&uuml;ckel limit ("sdh") where the protein is treated as a single charged sphere. Alternatively, one can treat the protein as polyion consisting of individual charged spheres that contribute linearly to the electrostatic potential at the boundary ("mdh"). The latter boundary model is computationally much more demanding.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>boundary condition model</td><td>"zero", "sdh" or "mdh"</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput">pdie</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>yes</td></tr><tr><td>behavior if missing</td><td>not possible</td></tr></tbody></table></div><p>Dielectric constant of the protein volume. A reasonable range of values is between 2.0 and 20.0 depending on the system. We recommend 4.0 if conformational flexibility is not included explicitly.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>protein dielectric constant</td><td>float</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput">sdie</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>yes</td></tr><tr><td>behavior if missing</td><td>not possible</td></tr></tbody></table></div><p>Dielectric constant of the continuum solvent. A reasonable value for water is 80.0.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>solvent dielectric constant</td><td>float</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput">temperature</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>no</td></tr><tr><td>behavior if missing</td><td>temperature 300.0</td></tr></tbody></table></div><p>The temperature in Kelvin. Necessary only for unit conversions from pK to kJ/mol and vice-versa.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>temperature</td><td>float</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput">ion</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>yes</td></tr><tr><td>required</td><td>yes</td></tr><tr><td>behavior if missing</td><td>not possible</td></tr></tbody></table></div><p>Specification of dissolved ion species defining the total ionic strength. For each ion species one has to provide its charge, concentration (M) and radius (Angstroms). The largest ion radius will be used to define the thickness of the Stern-layer, i.e. the region around the protein volume that is ion-inaccessible. The total net charge of all ion species must sum up to zero.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>ion charge</td><td>float</td><td>no</td><td>n/a</td></tr><tr><td>ion concentration in M</td><td>float</td><td>no</td><td>n/a</td></tr><tr><td>ion radius in Angstroms</td><td>float</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput">srfm</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>no</td></tr><tr><td>behavior if missing</td><td>srfm mol</td></tr></tbody></table></div><p>Specifiy the method of mapping the dielectric function onto the grid. This is done based on the molecular surface ("mol"). The solute-solvent interface can then be "smoothed" by 9-point harmonic averaging ("smol") to decrease sensitivity to the grid setup.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>Mapping of dielectric coefficient function</td><td>"mol" or "smol"</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput">srad</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>yes</td></tr><tr><td>behavior if missing</td><td>not possible</td></tr></tbody></table></div><p>Solvent probe radius in Angstroms is necessary to define the solvent-accessible surface area (SASA). For water a value of 1.4 Angstroms is reasonable.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>solvent probe radius</td><td>float</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput">sdens</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>no</td></tr><tr><td>behavior if missing</td><td>sdens 3.0</td></tr></tbody></table></div><p>Specifies the SASA point density, i.e. the resolution of the SASA. The molecular surface used to define the protein volume is calculated by roling a sphere with the solvent probe radius over the SASA represented by a set of points on which the probe spheres are centered. The smaller the probe radius the higher the resolution should be. A reasonable value is 3.0 pts/Angstrom^2 for a probe radius of 1.4 Angstroms (water). However, the APBS default is set 10.0 pts/Angstrom^2. This affects strongly the calculation time!</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>Surface density of SASA points in pts/Angstrom^2</td><td>float</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput">chgm</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>no</td></tr><tr><td>behavior if missing</td><td>chgm spl0</td></tr></tbody></table></div><p>Specify charge discretization method. Atomic partial charges will be mapped onto local grid points. This can be done by trilinear interpolation ("spl0") which smears point charges over the nearest grid points or, alternatively, by cubic B-spline interpolation ("spl2") that smears charges over nearest and next-nearest grid points. Results of cubic B-spline interpolation are less sensitive to grid spacing, length and position.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>charge mapping method</td><td>"spl0" or "spl2"</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput"><a name="dimension_of_protein_grid"></a>dimension_of_protein_grid</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>yes</td></tr><tr><td>required</td><td>yes</td></tr><tr><td>behavior if missing</td><td>not possible</td></tr></tbody></table></div><p><span class="application">TAPBS</span> calculates the electrostatic potential for each state of all titratable residues buried in the protein volume (protein calculations) and solvated in a model compound (model calculations). This involves the solution of the PBE discritized on grid. The parameter defines the dimension of this grid used in protein calculations in terms of the number of grid points.</p><p>To reduce the grid size necessary to include the whole protein volume <span class="application">TAPBS</span> supports the grid focusing procedure which breaks a single high resolution calculation into several focusing calculations with gradually increasing grid resolutions. Typically, one starts with a calulation on a large but coarse grid centered on the geometrical center of the protein structure and with its boundary grid points initialized by application of a reasonable boundary condition. The calculation is repeated on a second grid that is centered on a region of interest inside the protein and fully contained by the larger grid. This time, the grid is initialized by the focusing boundary condition, i.e. the boundary grid points of the smaller grid take the values of the corresponding grid points of the coarser grid.</p><p>Each focusing calculation has to be specified by a <code class="computeroutput">dimension_of_protein_grid</code> line together with the corresponding grid spacing and grid centering specifications. The following example</p><pre class="programlisting">dimension_of_protein_grid 65 65 65
spacing_of_protein_grid 3.0 3.0 3.0
center_of_protein_grid oncent

dimension_of_protein_grid 129 97 97
spacing_of_protein_grid 1.0 1.0 1.0
center_of_protein_grid oncent

dimension_of_protein_grid 97 97 97
spacing_of_protein_grid 0.25 0.25 0.25
center_of_protein_grid onsite
</pre><p>defines a three-step grid focusing procedure. <span class="application">TAPBS</span> will first perform a coarse grained calculation on a 3x64=192 Angstroms sized grid that is centered on the protein volume and uses the resulting electrostatic potential as boundary conditions for a calculation on a second and third fine grained grid with the last only being 24 Angstroms in size on the edges but centered on the titratable residue. As you can see the number of grid points can vary for each direction as well as in each focusing calculation.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>grid points in x-direction</td><td>integer</td><td>no</td><td>n/a</td></tr><tr><td>grid points in y-direction</td><td>integer</td><td>no</td><td>n/a</td></tr><tr><td>grid porints in z-direction</td><td>integer</td><td>no</td><td>n/a</td></tr></tbody></table></div><p>The number of grid points n used must obey the formula n=c2^(l+1)+1 where c is an integer factor and l the so-called grid level (integer). Typical values are 33, 65, 97, 129 and 161. This constraint is related to the numerical multi-grid algorithm implemented in APBS.</p></li><li><p><code class="computeroutput">dimension_of_model_grid</code></p><p>Defines the grid dimension used in model calculations. If omitted <span class="application">TAPBS</span> will use the same grid dimensions as defined for the protein calculations. The parameter follows the same syntax as <a href="#dimension_of_protein_grid"></a>. Usually, a smaller number of grid points is desirable for model calculations as the model structure is much smaller than the protein volume. A typical value is 65 in all spatial directions.</p></li><li><p><code class="computeroutput"><a name="spacing_of_protein_grid"></a>spacing_of_protein_grid</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>yes</td></tr><tr><td>required</td><td>yes</td></tr><tr><td>behavior if missing</td><td>not possible</td></tr></tbody></table></div><p>Specfies the spacing between the grid points in Angstroms, i.e. the grid resolution in protein calculations. Typical values range between 3.0 and 0.25 Angstroms. This statement can be used more than once but must balance with the number of <code class="computeroutput">dimension_of_protein_grid</code> lines. The order is relevant, i.e. the first <code class="computeroutput">spacing_of_protein_grid</code> line will correspond to the first <code class="computeroutput">dimension_of_protein_grid</code> statement.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>spacing in x-direction</td><td>float</td><td>no</td><td>n/a</td></tr><tr><td>spacing in y-direction</td><td>float</td><td>no</td><td>n/a</td></tr><tr><td>spacing in z-direction</td><td>float</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput">spacing_of_model_grid</code></p><p>Specifies the spacing between the grid points in model calculations. It follows the same rules as <a href="#spacing_of_protein_grid"></a>. Make sure that the resolution in the last focusing step is the same in both protein and model calculations. Otherwise the grid artefact will not cancel in the Born energy terms.</p></li><li><p><code class="computeroutput"><a name="center_of_protein_grid"></a>center_of_protein_grid</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>yes</td></tr><tr><td>required</td><td>yes</td></tr><tr><td>behavior if missing</td><td>not possible</td></tr></tbody></table></div><p>Specification of the centering method in protein calculations: Center the grid on the protein geometry ("oncent") or on the geometric center of the titratable residue ("onsite"). This statement can be used more than once but must balance with the number of <code class="computeroutput">dimension_of_protein_grid</code> lines. The order is relevant, i.e. the first <code class="computeroutput">center_of_protein_grid</code> line will correspond to the first <code class="computeroutput">dimension_of_protein_grid</code> statement.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>centering method</td><td>"oncent" or "onsite"</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput">center_of_model_grid</code></p><p>Specification of the centering method in model calculations. It follows the same rules as <a href="#center_of_protein_grid"></a>. Make sure that the centering method in the last focusing step is the same in both protein and model calculations. Otherwise the grid artefact will not cancel in the Born energy term.</p></li><li><p><code class="computeroutput">errtol</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>no</td></tr><tr><td>behavior if missing</td><td>errtol 1E-6</td></tr></tbody></table></div><p>The multi-grid approach is an iterative algorithm for solving the descritized PBE. The algorithm stops if convergence is reached. The convergence is defined in terms of the relative residual. If the relative residual is below the value specified the algorithm will stop refining the solution. <span class="application">TAPBS</span> uses the <span class="application">APBS</span> default of 1E-6. A faster and still accurate limit is 1E-3.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>Error tolerance in terms of relative residual</td><td>float</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput">itmax</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>no</td></tr><tr><td>behavior if missing</td><td>itmax 200</td></tr></tbody></table></div><p>Specifies the maximum number of multi-grid iterations. Affects convergence time independently from <code class="computeroutput">errtol</code>. We found that a value of 4 represents a reasonable trade-off between calculation times and accuracy.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>maximum number of multi-grid iterations</td><td>integer</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput"><a name="diel_atomno"></a>diel_atomno</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>yes</td></tr><tr><td>required</td><td>no</td></tr><tr><td>behavior if missing</td><td>nothing</td></tr></tbody></table></div><p><span class="application">TAPBS</span> supports the assignment of multiple dielectric constants within the protein volume. This done by defining the protein volume first on the basis of the molecular surface using a single dielectric constant specified by <code class="computeroutput">pdie</code> and then map additional dielectric constants onto the grid within the vdW-radii of the atoms specified in the <code class="computeroutput">diel_atomno</code>, <code class="computeroutput">diel_resid</code> or <code class="computeroutput">diel_segres</code> lines.</p><p>Arguments:</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>atom number</td><td>integer</td><td>no</td><td>n/a</td></tr><tr><td>dielectric constant</td><td>float</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput"><a name="diel_resid"></a>diel_resid</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>yes</td></tr><tr><td>required</td><td>no</td></tr><tr><td>behavior if missing</td><td>nothing</td></tr></tbody></table></div><p>See <code class="computeroutput">diel_atomno</code>.</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>segment name</td><td>string</td><td>no</td><td>n/a</td></tr><tr><td>residue number</td><td>integer</td><td>no</td><td>n/a</td></tr><tr><td>dielectric constant</td><td>float</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput"><a name="diel_segres"></a>diel_segres</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>yes</td></tr><tr><td>required</td><td>no</td></tr><tr><td>behavior if missing</td><td>nothing</td></tr></tbody></table></div><p>See <code class="computeroutput">diel_atomno</code>.</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>segment name</td><td>string</td><td>no</td><td>n/a</td></tr><tr><td>residue number</td><td>integer</td><td>no</td><td>n/a</td></tr><tr><td>dielectric constant</td><td>float</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput"><a name="dummy"></a>dummy</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>no</td></tr><tr><td>behavior if missing</td><td>full calculation of electrostatic potentials</td></tr></tbody></table></div><p>If the dummy flag is found in the input <span class="application">TAPBS</span> will only simulate a full titration calculation, i.e. the PBE is not actually solved but the solution array set to zero. However, structure manipulations, calculations of the molecular surface, the intrinsic pKs and W matrix entries will be performed. This is good for testing to check whether the computation is set up correctly.</p><p>No further arguments are required for this keyword.</p></li><li><p><a name="membrane"></a><code class="computeroutput">membrane</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>no</td></tr><tr><td>behavior if missing</td><td>nothing</td></tr></tbody></table></div><p><span class="application">TAPBS</span> supports the assignment of an implicit membrane characterized by a volume slab on the grid around the protein assigned a different dielectric constant. The keyword is supplied two vectors: The first represents the support vector describing the translation of the membrane plane from the origin, the second the orientation and thickness of the volume slab. The protein coordinates and both vectors will be rotated so that the plane normal vector of the membrane will coalign with the z-axis. The volume slab between the resulting zmin and zmax value will be assigned the dielectric constant given as the last parameter. Note, that the membrane slab makes computations slightly slower and might need a higher resolution. Use the keyword <a href="#writemap">writemap</a> to write out and check (using a tool like VMD for visualization) the dielectric constant maps used.</p><div class="informaltable"><table border="1"><colgroup><col width="25%"><col width="25%"><col width="25%"><col width="25%"></colgroup><thead><tr><th align="center">description</th><th align="center">format</th><th align="center">optional</th><th align="center">default value</th></tr></thead><tbody><tr><td>x-component of support vector</td><td>float</td><td>no</td><td>n/a</td></tr><tr><td>y-component of support vector</td><td>float</td><td>no</td><td>n/a</td></tr><tr><td>z-component of support vector</td><td>float</td><td>no</td><td>n/a</td></tr><tr><td>x-component of membrane vector</td><td>float</td><td>no</td><td>n/a</td></tr><tr><td>y-component of membrane vector</td><td>float</td><td>no</td><td>n/a</td></tr><tr><td>z-component of membrane vector</td><td>float</td><td>no</td><td>n/a</td></tr><tr><td>dielectric constant of volume slab</td><td>float</td><td>no</td><td>n/a</td></tr></tbody></table></div></li><li><p><code class="computeroutput"><a name="writemap"></a>writemap</code></p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><tbody><tr><td>usable more than once</td><td>no</td></tr><tr><td>required</td><td>no</td></tr><tr><td>behavior if missing</td><td>nothing</td></tr></tbody></table></div><p>The writemap flag tells <span class="application">TAPBS</span> to write dielectric and ion accessiblity maps into files. The format used is DX which VMD is able to visualize. As these maps consume quite a lot of disk space, be sure you limit the number of titratable residues in the SITES file. The keyword is used for debugging.</p><p>No further arguments are required for this keyword.</p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1515"></a>5.&nbsp;File formats</h2></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1518"></a>5.1.&nbsp;PQR file format</h3></div></div></div><p><span class="application">TAPBS</span> parses PQR files strictly according to the PDB file format specification. However, all lines that do not begin with "ATOM" are ignored. The occupancy section is used for atomic partial charges, while B-factor section is used for atomic radii. Make sure that each line contains at least 75 characters even when the segment name section is left empty. Do not use tab characters for formatting. Here is an example PQR line that should parse correctly:</p><pre class="programlisting">ATOM    545 CD   GLU L  35       5.145  15.745  26.036  0.62  2.00      LYSZ  </pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1527"></a>5.2.&nbsp;SITES files (*.sites)</h3></div></div></div><p>Sites files are simple text file in which each line defines a titratable residue by giving 1) the segment name, 2) residue number, 3) the residue name and finally the file name of a designated residue state description file (see below). It follows an example file that should parse correctly:</p><pre class="programlisting">A 8 ASP ASP.st</pre><p>Alternatively, if the protein structure does contain only a single segment (e.g. in case of a small single chain protein without cofactors), one can skip the leading segment name.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1536"></a>5.3.&nbsp;Residue state description files (*.ST)</h3></div></div></div><p>The residue state description files simply list the possible states that a titratable residue can adopt. In <span class="application">TAPBS</span> a state can be either a charge set or a conformation, the latter involving a change in the coordaintes or radii. Each state is described by a single line providing the so-called model energy shift (measured or calculated ab-initio in solution) and a transition state identifier. It is followed by a list of charges and/or coordinates in PQR format. For convenience, several different energy units are supported (until now only 'pK'). The transition type identifiers are the same as defined by <span class="application">Karlsberg 2.0</span> (see its user guide): 'P', 'D', '+', '-' and all possible combinations as well as '0' for conformational transitions or 'R' for the reference state. One of the states in the ST-File must be the reference state. Energy shifts are always relative to the reference. Here is an example file describing the deprotonation of glutamate:</p><pre class="programlisting">0.00 pK R
ATOM      1 CG   GLU     1    9999.9999999.9999999.999-0.21099.999      GLU   
ATOM      2 CD   GLU     1    9999.9999999.9999999.999 0.75099.999      GLU   
ATOM      3 OE1  GLU     1    9999.9999999.9999999.999-0.36099.999      GLU   
ATOM      4 OE2  GLU     1    9999.9999999.9999999.999-0.36099.999      GLU   
4.40 pK D
ATOM      1 CG   GLU     1    9999.9999999.9999999.999-0.28099.999      GLU   
ATOM      2 CD   GLU     1    9999.9999999.9999999.999 0.62099.999      GLU   
ATOM      3 OE1  GLU     1    9999.9999999.9999999.999-0.76099.999      GLU   
ATOM      4 OE2  GLU     1    9999.9999999.9999999.999-0.76099.999      GLU     </pre><p>"ATOM", atom numbers, residue names, residue numbers and segment names are ignored. The atom names, however, must coincide with those found in this residue. For transitions that leave coordinates untouched the string '9999.999' found in the coordinate columns will be replaced by values found in the PQR file. For invariant charges or radii the string '99.999' will be replaced by values found in the PQR file.</p><p>It follows an example ST-file that describes the three-fold state transition of Histidine:</p><pre class="programlisting">0.00 pK R
ATOM   4935  CB  HSP A 102    9999.9999999.9999999.999-0.09099.999      A    C
ATOM   4938  CD2 HSP A 102    9999.9999999.9999999.999 0.22099.999      A    C
ATOM   4939  HD2 HSP A 102    9999.9999999.9999999.999 0.10099.999      A    H
ATOM   4940  CG  HSP A 102    9999.9999999.9999999.999-0.05099.999      A    C
ATOM   4941  NE2 HSP A 102    9999.9999999.9999999.999-0.70099.999      A    N
ATOM   4942  HE2 HSP A 102    9999.9999999.9999999.999 0.00099.999      A    H
ATOM   4943  ND1 HSP A 102    9999.9999999.9999999.999-0.36099.999      A    N
ATOM   4944  HD1 HSP A 102    9999.9999999.9999999.999 0.32099.999      A    H
ATOM   4945  CE1 HSP A 102    9999.9999999.9999999.999 0.25099.999      A    C
ATOM   4946  HE1 HSP A 102    9999.9999999.9999999.999 0.13099.999      A    H
-7.00 pK P
ATOM   4935  CB  HSP A 102    9999.9999999.9999999.999-0.05099.999      A    C
ATOM   4938  CD2 HSP A 102    9999.9999999.9999999.999 0.19099.999      A    C
ATOM   4939  HD2 HSP A 102    9999.9999999.9999999.999 0.13099.999      A    H
ATOM   4940  CG  HSP A 102    9999.9999999.9999999.999 0.19099.999      A    C
ATOM   4941  NE2 HSP A 102    9999.9999999.9999999.999-0.51099.999      A    N
ATOM   4942  HE2 HSP A 102    9999.9999999.9999999.999 0.44099.999      A    H
ATOM   4943  ND1 HSP A 102    9999.9999999.9999999.999-0.51099.999      A    N
ATOM   4944  HD1 HSP A 102    9999.9999999.9999999.999 0.44099.999      A    H
ATOM   4945  CE1 HSP A 102    9999.9999999.9999999.999 0.32099.999      A    C
ATOM   4946  HE1 HSP A 102    9999.9999999.9999999.999 0.18099.999      A    H
-0.40 pK 0
ATOM   4935  CB  HSP A 102    9999.9999999.9999999.999-0.08099.999      A    C
ATOM   4938  CD2 HSP A 102    9999.9999999.9999999.999-0.05099.999      A    C
ATOM   4939  HD2 HSP A 102    9999.9999999.9999999.999 0.09099.999      A    H
ATOM   4940  CG  HSP A 102    9999.9999999.9999999.999 0.22099.999      A    C
ATOM   4941  NE2 HSP A 102    9999.9999999.9999999.999-0.36099.999      A    N
ATOM   4942  HE2 HSP A 102    9999.9999999.9999999.999 0.32099.999      A    H
ATOM   4943  ND1 HSP A 102    9999.9999999.9999999.999-0.70099.999      A    N
ATOM   4944  HD1 HSP A 102    9999.9999999.9999999.999 0.00099.999      A    H
ATOM   4945  CE1 HSP A 102    9999.9999999.9999999.999 0.25099.999      A    C
ATOM   4946  HE1 HSP A 102    9999.9999999.9999999.999 0.13099.999      A    H</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1555"></a>5.4.&nbsp;Potential binary file format</h3></div></div></div><p>The calculated electrostatic potentials are evaluated on all atom positions and stored into a binary file that contains the potentials for all states of a titratable residue from protein and model calculations. The file structure is as follows:</p><div class="informaltable"><table border="1"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr><th align="center">field description</th><th align="center">type</th></tr></thead><tbody><tr><td>Number of states</td><td>int</td></tr><tr><td>Number of atoms</td><td>int</td></tr><tr><td>x position (Angstroms)</td><td>double</td></tr><tr><td>y position (Angstroms)</td><td>double</td></tr><tr><td>z position (Angstroms)</td><td>double</td></tr><tr><td>potential value (kT/ec)</td><td>double</td></tr><tr><td>...</td><td class="auto-generated">&nbsp;</td></tr><tr><td>Number of states</td><td>int</td></tr><tr><td>Number of atoms</td><td>int</td></tr><tr><td>x position (Angstroms)</td><td>double</td></tr><tr><td>y position (Angstroms)</td><td>double</td></tr><tr><td>z position (Angstroms)</td><td>double</td></tr><tr><td>potential value (kT/ec)</td><td>double</td></tr><tr><td>...</td><td class="auto-generated">&nbsp;</td></tr></tbody></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1635"></a>5.5.&nbsp;Intrinsic pK values (*.pkint)</h3></div></div></div><p>For a description of this file format please consult the documentation of <span class="application">Karlsberg2</span><em class="parameter"><code>.</code></em></p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1644"></a>5.6.&nbsp;W interaction matrix (*.g)</h3></div></div></div><p>For a description of this file format please consult the documentation of Karlsberg2.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1649"></a>6.&nbsp;Copyright</h2></div></div></div><p>TAPBS Copyright 2007 Gernot Kieseritzky, <code class="email">&lt;<a href="mailto:gernotf@chemie.fu-berlin.de">gernotf@chemie.fu-berlin.de</a>&gt;</code></p>
<p>TAPBS 0.2 2011 Ilkay Sakalli <code class="email">&lt;<a href="mailto:sakalli@chemie.fu-berlin.de">sakalli@chemie.fu-berlin.de</a>&gt;</code></p>
<p>TAPBS was written by Gernot Kieseritzky and modified by Ilkay Sakalli in the macromolecular modelling group of E. W. Knapp at the Freie Universit&auml;t Berlin. Please acknowledge your use of TAPBS 0.1 by citing</p><p>[<span class="citation">G. Kieseritzky &amp; E. W. Knapp (2007)</span>] <em class="citetitle">Optimizing pKa computations in proteins with pH adapted conformations (PACs).</em> Proteins. in press.</p><p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p><p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p><p>You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</p></div></div></body></html>
